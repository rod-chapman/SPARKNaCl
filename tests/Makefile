all: fntr sntr ftestdiff stestdiff

fall: fntr ftestdiff

ftestdiff: fntr
	diff expected_test_results fntr

stestdiff: sntr
	diff expected_test_results sntr

fntr: ftestall
	./ftestall >fntr

sntr: stestall
	./stestall >sntr

ftestall: *.adb ../src/*.adb ../src/*.ads
	gprclean -r -Ptestall
	rm -f fntr
	rm -f ftestall
	gprbuild -j4 -Ptestall -XSPARKNACL_RUNTIME_CHECKS=disabled -XSPARKNACL_CONTRACTS=disabled -XSPARKNACL_BUILD_MODE=O3
	mv testall ftestall

stestall: *.adb ../src/*.adb ../src/*.ads
	gprclean -r -Ptestall
	rm -f sntr
	rm -f stestall
	gprbuild -j4 -Ptestall -XSPARKNACL_RUNTIME_CHECKS=enabled -XSPARKNACL_CONTRACTS=enabled -XSPARKNACL_BUILD_MODE=debug
	mv testall stestall

scalarspeed: scalarspeed.adb ../src/*.adb ../src/*.ads
	gprclean -r -Pscalarspeed
	rm -f scalarspeed
	gprbuild -j4 -Pscalarspeed -XSPARKNACL_RUNTIME_CHECKS=disabled -XSPARKNACL_CONTRACTS=disabled -XSPARKNACL_BUILD_MODE=O3

clean:
	gprclean -r -Ptestall
	rm -f ftestall
	rm -f stestall
	rm -f scalarspeed
	rm -f fntr
	rm -f sntr
